<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Install and use &mdash; milabench  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Running Milabench" href="recipes.html" />
    <link rel="prev" title="Welcome to milabench’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            milabench
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Install and use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#before-running-the-benchmarks">Before running the benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-milabench">Run milabench</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reports">Reports</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Running Milabench</a></li>
<li class="toctree-l1"><a class="reference internal" href="new_benchmarks.html">Creating a new benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-usage.html">Using milabench (DEVELOPERS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="sizer.html">Scaling</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">milabench</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Install and use</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="install-and-use">
<h1>Install and use<a class="headerlink" href="#install-and-use" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may use Docker to run the benchmarks, which will likely be easier. See the Docker section of this documentation for more information.</p>
</div>
<p>To install, clone the repo:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># You may need to upgrade pip</span>
pip<span class="w"> </span>install<span class="w"> </span>pip<span class="w"> </span>-U
git<span class="w"> </span>clone<span class="w"> </span>git@github.com:mila-iqia/milabench.git
<span class="nb">cd</span><span class="w"> </span>milabench
<span class="c1"># &lt;Activate virtual environment&gt;</span>
<span class="c1"># Install in editable mode</span>
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
<p>This will install two commands, <code class="docutils literal notranslate"><span class="pre">milabench</span></code> and <code class="docutils literal notranslate"><span class="pre">voir</span></code>.</p>
<section id="before-running-the-benchmarks">
<h2>Before running the benchmarks<a class="headerlink" href="#before-running-the-benchmarks" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">$MILABENCH_BASE</span></code> environment variable to the base directory in which all the code, virtual environments and data should be put.</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">$MILABENCH_CONFIG</span></code> environment variable to the configuration file that represents the benchmark suite you want to run. Normally it should be set to <code class="docutils literal notranslate"><span class="pre">config/standard.yaml</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">milabench</span> <span class="pre">install</span></code>: Install the individual benchmarks in virtual environments.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">milabench</span> <span class="pre">prepare</span></code>: Download the datasets, weights, etc.</p></li>
</ol>
<p>If the machine has both NVIDIA/CUDA and AMD/ROCm GPUs, you may have to set the <code class="docutils literal notranslate"><span class="pre">MILABENCH_GPU_ARCH</span></code> environment variable as well, to either <code class="docutils literal notranslate"><span class="pre">cuda</span></code> or <code class="docutils literal notranslate"><span class="pre">rocm</span></code>.</p>
</section>
<section id="run-milabench">
<h2>Run milabench<a class="headerlink" href="#run-milabench" title="Link to this heading"></a></h2>
<p>The following command will run the whole benchmark and will put the results in a new directory in <code class="docutils literal notranslate"><span class="pre">$MILABENCH_BASE/runs</span></code> (the path will be printed to stdout).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>milabench<span class="w"> </span>run
</pre></div>
</div>
<p>Here are a few useful options for <code class="docutils literal notranslate"><span class="pre">milabench</span> <span class="pre">run</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Only run the bert benchmark</span>
milabench<span class="w"> </span>run<span class="w"> </span>--select<span class="w"> </span>bert

<span class="c1"># Run all benchmarks EXCEPT bert and stargan</span>
milabench<span class="w"> </span>run<span class="w"> </span>--exclude<span class="w"> </span>bert,stargan

<span class="c1"># Run the benchmark suite three times in a row</span>
milabench<span class="w"> </span>run<span class="w"> </span>--repeat<span class="w"> </span><span class="m">3</span>
</pre></div>
</div>
</section>
<section id="reports">
<h2>Reports<a class="headerlink" href="#reports" title="Link to this heading"></a></h2>
<p>The following command will print out a report of the tests that ran, the metrics and if there were any failures. It will also produce an HTML report that contains more detailed information about errors if there are any.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>milabench<span class="w"> </span>report<span class="w"> </span>--runs<span class="w"> </span><span class="nv">$MILABENCH_BASE</span>/runs/some_specific_run<span class="w"> </span>--html<span class="w"> </span>report.html
</pre></div>
</div>
<p>The report will also print out a score based on a weighting of the metrics, as defined in the file <code class="docutils literal notranslate"><span class="pre">$MILABENCH_CONFIG</span></code> points to.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to milabench’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="recipes.html" class="btn btn-neutral float-right" title="Running Milabench" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Mila IDT.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>