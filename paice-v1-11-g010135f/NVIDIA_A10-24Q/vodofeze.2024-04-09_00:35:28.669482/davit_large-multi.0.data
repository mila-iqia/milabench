{"event": "config", "data": {"system": {"arch": "cuda", "sshkey": null, "nodes": [{"aliaslist": [], "hostname": "delicatemastodon.eastus2.cloudapp.azure.com", "ip": "delicatemastodon.eastus2.cloudapp.azure.com", "ipaddrlist": ["00:00:00:00:00:00", "fe80::6245:bdff:feb3:312b%eth0", "60:45:bd:b3:31:2b", "10.0.1.4", "127.0.0.1", "::1"], "key": "/Users/satyaortiz-gagne/.ssh/covalent-azure-task-a10_x2-4db6f1500e0007c61a4cf0533daca445/id_rsa.covalent.delicatemastodon.pem", "local": true, "main": true, "name": "manager", "user": "ubuntu"}], "cloud_profiles": {"azure__a100": {"location": "eastus2", "size": "Standard_NC24ads_A100_v4", "username": "ubuntu"}, "azure__a100_x2": {"location": "eastus2", "size": "Standard_NC48ads_A100_v4", "username": "ubuntu"}, "azure__a10_x2": {"location": "eastus2", "size": "Standard_NV72ads_A10_v5", "username": "ubuntu"}}, "self": {"aliaslist": [], "hostname": "delicatemastodon.eastus2.cloudapp.azure.com", "ip": "delicatemastodon.eastus2.cloudapp.azure.com", "ipaddrlist": ["00:00:00:00:00:00", "fe80::6245:bdff:feb3:312b%eth0", "60:45:bd:b3:31:2b", "10.0.1.4", "127.0.0.1", "::1"], "key": "/Users/satyaortiz-gagne/.ssh/covalent-azure-task-a10_x2-4db6f1500e0007c61a4cf0533daca445/id_rsa.covalent.delicatemastodon.pem", "local": true, "main": true, "name": "manager", "user": "ubuntu"}}, "dirs": {"base": "/Users/satyaortiz-gagne/travail/mila/milabench", "venv": "/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch", "data": "/Users/satyaortiz-gagne/travail/mila/milabench/data", "runs": "/Users/satyaortiz-gagne/travail/mila/milabench/runs", "extra": "/Users/satyaortiz-gagne/travail/mila/milabench/extra/timm", "cache": "/Users/satyaortiz-gagne/travail/mila/milabench/cache"}, "group": "timm", "install_group": "torch", "install_variant": "cuda", "run_name": "vodofeze.2024-04-09_00:35:28.669482", "enabled": true, "capabilities": {"nodes": 1}, "max_duration": 600, "voir": {"options": {"stop": 60, "interval": "1s"}}, "validation": {"usage": {"gpu_load_threshold": 0.5, "gpu_mem_threshold": 0.5}}, "config_base": "/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/config", "config_file": "/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/config/standard.yaml", "hash": "f8568b3c26182a7cfabab1ca058f33bf", "definition": "/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm", "plan": {"method": "njobs", "n": 1}, "argv": {"--amp": true, "--model": "davit_large", "--batch-size": 128, "--lr-base": 0.01}, "tags": ["classification", "multigpu", "transformer", "vision"], "weight": 5.0, "name": "davit_large-multi", "tag": ["davit_large-multi", "0"], "job-number": 0, "devices": ["0", "1"]}, "pipe": null}
{"event": "meta", "data": {"cpu": {"count": 72, "brand": "AMD EPYC 74F3 24-Core Processor"}, "os": {"sysname": "Linux", "nodename": "delicatemastodon", "release": "6.5.0-1017-azure", "version": "#17~22.04.1-Ubuntu SMP Sat Mar  9 04:50:38 UTC 2024", "machine": "x86_64"}, "accelerators": {"arch": "cuda", "gpus": {"GPU-5701be00-f607-11ee-a28f-e97901091b3e": {"device": "0", "product": "NVIDIA A10-24Q", "memory": {"used": 2390.25, "total": 24512.0}, "utilization": {"compute": 0, "memory": 0.09751346279373369}, "temperature": null, "power": null, "selection_variable": "CUDA_VISIBLE_DEVICES"}, "GPU-5701be00-f607-11ee-a28f-f106fd37d291": {"device": "1", "product": "NVIDIA A10-24Q", "memory": {"used": 2390.25, "total": 24512.0}, "utilization": {"compute": 0, "memory": 0.09751346279373369}, "temperature": null, "power": null, "selection_variable": "CUDA_VISIBLE_DEVICES"}}}, "date": 1712623520.930649, "milabench": {"tag": "paice-v1-11-g010135f", "commit": "010135f53e9664ae61b596149e569230d8b45f44", "date": "2024-04-03 00:41:57 -0400"}, "pytorch": {"torch": "2.1.0+cu118", "compiler": "GCC 9.3", "cpp": "C++ Version: 201703", "intel": "Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications", "mkl": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "openmp": "OpenMP 201511 (a.k.a. OpenMP 4.5)", "lapack": "LAPACK is enabled (usually provided by MKL)", "nnpack": "NNPACK is enabled", "cpu": "CPU capability usage: AVX2", "build_settings": {"BLAS_INFO": "mkl", "BUILD_TYPE": "Release", "CUDA_VERSION": "11.8", "CUDNN_VERSION": "8.7.0", "CXX_COMPILER": "/opt/rh/devtoolset-9/root/usr/bin/c++", "CXX_FLAGS": "-D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-invalid-partial-specialization -Wno-unused-private-field -Wno-aligned-allocation-unavailable -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow", "LAPACK_INFO": "mkl", "PERF_WITH_AVX": "1", "PERF_WITH_AVX2": "1", "PERF_WITH_AVX512": "1", "TORCH_DISABLE_GPU_ASSERTS": "ON", "TORCH_VERSION": "2.1.0", "USE_CUDA": "ON", "USE_CUDNN": "ON", "USE_EXCEPTION_PTR": "1", "USE_GFLAGS": "OFF", "USE_GLOG": "OFF", "USE_MKL": "ON", "USE_MKLDNN": "ON", "USE_MPI": "OFF", "USE_NCCL": "1", "USE_NNPACK": "ON", "USE_OPENMP": "ON", "USE_ROCM": "OFF"}}}, "pipe": null}
{"event": "start", "data": {"command": ["torchrun", "--nproc_per_node=2", "--", "-m", "voir", "--config", "/Users/satyaortiz-gagne/travail/mila/milabench/extra/timm/voirconf-davit_large-multi.0-0efae956f1553a76c1e03985181900f5.json", "/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py", "--amp", "--model", "davit_large", "--batch-size", "128", "--lr-base", "0.01", "--data-dir", "/Users/satyaortiz-gagne/travail/mila/milabench/data", "--dataset", "FakeImageNet", "--output", "/Users/satyaortiz-gagne/travail/mila/milabench/extra/timm/vodofeze.2024-04-09_00:35:28.669482/davit_large-multi.0", "--checkpoint-hist", "1"], "time": 1712623520.9466906}, "pipe": null}
{"event": "phase", "data": {"name": "init"}, "pipe": "data"}
{"event": "phase", "data": {"name": "init"}, "pipe": "data"}
{"event": "phase", "data": {"name": "parse_args"}, "pipe": "data"}
{"event": "phase", "data": {"name": "load_script"}, "pipe": "data"}
{"event": "phase", "data": {"name": "parse_args"}, "pipe": "data"}
{"event": "phase", "data": {"name": "load_script"}, "pipe": "data"}
{"event": "phase", "data": {"name": "run_script"}, "pipe": "data"}
{"event": "line", "data": "Training in distributed mode with multiple processes, 1 device per process.Process 1, total 2, device cuda:1.\n", "pipe": "stderr"}
{"event": "phase", "data": {"name": "run_script"}, "pipe": "data"}
{"event": "line", "data": "Training in distributed mode with multiple processes, 1 device per process.Process 0, total 2, device cuda:0.\n", "pipe": "stderr"}
{"event": "line", "data": "Model davit_large created, param count:196811752\n", "pipe": "stderr"}
{"event": "line", "data": "Data processing configuration for current model + dataset:\n", "pipe": "stderr"}
{"event": "line", "data": "\tinput_size: (3, 224, 224)\n", "pipe": "stderr"}
{"event": "line", "data": "\tinterpolation: bicubic\n", "pipe": "stderr"}
{"event": "line", "data": "\tmean: (0.485, 0.456, 0.406)\n", "pipe": "stderr"}
{"event": "line", "data": "\tstd: (0.229, 0.224, 0.225)\n", "pipe": "stderr"}
{"event": "line", "data": "\tcrop_pct: 0.95\n", "pipe": "stderr"}
{"event": "line", "data": "\tcrop_mode: center\n", "pipe": "stderr"}
{"event": "line", "data": "Learning rate (0.01) calculated from base learning rate (0.01) and global batch size (256) with linear scaling.\n", "pipe": "stderr"}
{"event": "line", "data": "Using native Torch AMP. Training in mixed precision.\n", "pipe": "stderr"}
{"event": "line", "data": "Using native Torch DistributedDataParallel.\n", "pipe": "stderr"}
{"event": "line", "data": "Scheduled epochs: 300. LR stepped per epoch.\n", "pipe": "stderr"}
{"event": "line", "data": "/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Applied workaround for CuDNN issue, install nvrtc.so (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:80.)\n", "pipe": "stderr"}
{"event": "line", "data": "  return F.conv2d(input, weight, bias, self.stride,\n", "pipe": "stderr"}
{"event": "line", "data": "/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Applied workaround for CuDNN issue, install nvrtc.so (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:80.)\n", "pipe": "stderr"}
{"event": "line", "data": "  return F.conv2d(input, weight, bias, self.stride,\n", "pipe": "stderr"}
{"event": "data", "data": {"task": "main", "gpudata": {"0": {"memory": [7064.3125, 24512.0], "load": 0.06, "temperature": null, "power": null}, "1": {"memory": [7064.3125, 24512.0], "load": 0.06, "temperature": null, "power": null}}}, "pipe": "data"}
{"event": "data", "data": {"task": "main", "gpudata": {"0": {"memory": [24346.3125, 24512.0], "load": 0.39, "temperature": null, "power": null}, "1": {"memory": [24346.3125, 24512.0], "load": 0.41, "temperature": null, "power": null}}}, "pipe": "data"}
{"event": "error", "data": {"type": "OutOfMemoryError", "message": "CUDA out of memory. Tried to allocate 148.00 MiB. GPU 0 has a total capacty of 23.73 GiB of which 165.69 MiB is free. Including non-PyTorch memory, this process has 21.44 GiB memory in use. Of the allocated memory 20.89 GiB is allocated by PyTorch, and 162.76 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF"}, "pipe": "data"}
{"event": "phase", "data": {"name": "finalize"}, "pipe": "data"}
{"event": "line", "data": "Traceback (most recent call last):\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/home/ubuntu/miniconda3/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n", "pipe": "stderr"}
{"event": "line", "data": "    return _run_code(code, main_globals, None,\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/home/ubuntu/miniconda3/lib/python3.10/runpy.py\", line 86, in _run_code\n", "pipe": "stderr"}
{"event": "line", "data": "    exec(code, run_globals)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/__main__.py\", line 4, in <module>\n", "pipe": "stderr"}
{"event": "line", "data": "    main()\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/cli.py\", line 124, in main\n", "pipe": "stderr"}
{"event": "line", "data": "    ov(sys.argv[1:] if argv is None else argv)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/phase.py\", line 334, in __call__\n", "pipe": "stderr"}
{"event": "line", "data": "    self._run(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/overseer.py\", line 242, in _run\n", "pipe": "stderr"}
{"event": "line", "data": "    set_value(func())\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/scriptutils.py\", line 37, in <lambda>\n", "pipe": "stderr"}
{"event": "line", "data": "    return lambda: exec(mainsection, glb, glb)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py\", line 1035, in <module>\n", "pipe": "stderr"}
{"event": "line", "data": "    main()\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py\", line 759, in main\n", "pipe": "stderr"}
{"event": "line", "data": "    train_metrics = train_one_epoch(\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py\", line 874, in train_one_epoch\n", "pipe": "stderr"}
{"event": "line", "data": "    output = model(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py\", line 1519, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    else self._run_ddp_forward(*inputs, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py\", line 1355, in _run_ddp_forward\n", "pipe": "stderr"}
{"event": "line", "data": "    return self.module(*inputs, **kwargs)  # type: ignore[index]\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 575, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.forward_features(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 563, in forward_features\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.stages(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/container.py\", line 215, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    input = module(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 433, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.blocks(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/container.py\", line 215, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    input = module(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/container.py\", line 215, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    input = module(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 186, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = x + self.drop_path2(self.mlp(self.norm2(x)))\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/layers/mlp.py\", line 41, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.act(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/activation.py\", line 682, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    return F.gelu(input, approximate=self.approximate)\n", "pipe": "stderr"}
{"event": "line", "data": "torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 148.00 MiB. GPU 0 has a total capacty of 23.73 GiB of which 165.69 MiB is free. Including non-PyTorch memory, this process has 21.44 GiB memory in use. Of the allocated memory 20.89 GiB is allocated by PyTorch, and 162.76 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF\n", "pipe": "stderr"}
{"event": "error", "data": {"type": "OutOfMemoryError", "message": "CUDA out of memory. Tried to allocate 148.00 MiB. GPU 1 has a total capacty of 23.73 GiB of which 165.69 MiB is free. Including non-PyTorch memory, this process has 21.44 GiB memory in use. Of the allocated memory 20.89 GiB is allocated by PyTorch, and 162.76 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF"}, "pipe": "data"}
{"event": "phase", "data": {"name": "finalize"}, "pipe": "data"}
{"event": "line", "data": "Traceback (most recent call last):\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/home/ubuntu/miniconda3/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n", "pipe": "stderr"}
{"event": "line", "data": "    return _run_code(code, main_globals, None,\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/home/ubuntu/miniconda3/lib/python3.10/runpy.py\", line 86, in _run_code\n", "pipe": "stderr"}
{"event": "line", "data": "    exec(code, run_globals)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/__main__.py\", line 4, in <module>\n", "pipe": "stderr"}
{"event": "line", "data": "    main()\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/cli.py\", line 124, in main\n", "pipe": "stderr"}
{"event": "line", "data": "    ov(sys.argv[1:] if argv is None else argv)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/phase.py\", line 334, in __call__\n", "pipe": "stderr"}
{"event": "line", "data": "    self._run(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/overseer.py\", line 242, in _run\n", "pipe": "stderr"}
{"event": "line", "data": "    set_value(func())\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/voir/scriptutils.py\", line 37, in <lambda>\n", "pipe": "stderr"}
{"event": "line", "data": "    return lambda: exec(mainsection, glb, glb)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py\", line 1035, in <module>\n", "pipe": "stderr"}
{"event": "line", "data": "    main()\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py\", line 759, in main\n", "pipe": "stderr"}
{"event": "line", "data": "    train_metrics = train_one_epoch(\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py\", line 874, in train_one_epoch\n", "pipe": "stderr"}
{"event": "line", "data": "    output = model(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py\", line 1519, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    else self._run_ddp_forward(*inputs, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/parallel/distributed.py\", line 1355, in _run_ddp_forward\n", "pipe": "stderr"}
{"event": "line", "data": "    return self.module(*inputs, **kwargs)  # type: ignore[index]\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 575, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.forward_features(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 563, in forward_features\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.stages(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/container.py\", line 215, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    input = module(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 433, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.blocks(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/container.py\", line 215, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    input = module(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/container.py\", line 215, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    input = module(input)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/models/davit.py\", line 186, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = x + self.drop_path2(self.mlp(self.norm2(x)))\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/timm/layers/mlp.py\", line 41, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    x = self.act(x)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return self._call_impl(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n", "pipe": "stderr"}
{"event": "line", "data": "    return forward_call(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/nn/modules/activation.py\", line 682, in forward\n", "pipe": "stderr"}
{"event": "line", "data": "    return F.gelu(input, approximate=self.approximate)\n", "pipe": "stderr"}
{"event": "line", "data": "torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 148.00 MiB. GPU 1 has a total capacty of 23.73 GiB of which 165.69 MiB is free. Including non-PyTorch memory, this process has 21.44 GiB memory in use. Of the allocated memory 20.89 GiB is allocated by PyTorch, and 162.76 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF\n", "pipe": "stderr"}
{"event": "line", "data": "[2024-04-09 00:45:31,977] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 51458) of binary: /mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/bin/python\n", "pipe": "stderr"}
{"event": "line", "data": "Traceback (most recent call last):\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/bin/torchrun\", line 8, in <module>\n", "pipe": "stderr"}
{"event": "line", "data": "    sys.exit(main())\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py\", line 346, in wrapper\n", "pipe": "stderr"}
{"event": "line", "data": "    return f(*args, **kwargs)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/distributed/run.py\", line 806, in main\n", "pipe": "stderr"}
{"event": "line", "data": "    run(args)\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/distributed/run.py\", line 797, in run\n", "pipe": "stderr"}
{"event": "line", "data": "    elastic_launch(\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/distributed/launcher/api.py\", line 134, in __call__\n", "pipe": "stderr"}
{"event": "line", "data": "    return launch_agent(self._config, self._entrypoint, list(args))\n", "pipe": "stderr"}
{"event": "line", "data": "  File \"/mnt/Users/satyaortiz-gagne/travail/mila/milabench/venv/torch/lib/python3.10/site-packages/torch/distributed/launcher/api.py\", line 264, in launch_agent\n", "pipe": "stderr"}
{"event": "line", "data": "    raise ChildFailedError(\n", "pipe": "stderr"}
{"event": "line", "data": "torch.distributed.elastic.multiprocessing.errors.ChildFailedError: \n", "pipe": "stderr"}
{"event": "line", "data": "============================================================\n", "pipe": "stderr"}
{"event": "line", "data": "voir FAILED\n", "pipe": "stderr"}
{"event": "line", "data": "------------------------------------------------------------\n", "pipe": "stderr"}
{"event": "line", "data": "Failures:\n", "pipe": "stderr"}
{"event": "line", "data": "[1]:\n", "pipe": "stderr"}
{"event": "line", "data": "  time      : 2024-04-09_00:45:31\n", "pipe": "stderr"}
{"event": "line", "data": "  host      : delicatemastodon.internal.cloudapp.net\n", "pipe": "stderr"}
{"event": "line", "data": "  rank      : 1 (local_rank: 1)\n", "pipe": "stderr"}
{"event": "line", "data": "  exitcode  : 1 (pid: 51459)\n", "pipe": "stderr"}
{"event": "line", "data": "  error_file: <N/A>\n", "pipe": "stderr"}
{"event": "line", "data": "  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html\n", "pipe": "stderr"}
{"event": "line", "data": "------------------------------------------------------------\n", "pipe": "stderr"}
{"event": "line", "data": "Root Cause (first observed failure):\n", "pipe": "stderr"}
{"event": "line", "data": "[0]:\n", "pipe": "stderr"}
{"event": "line", "data": "  time      : 2024-04-09_00:45:31\n", "pipe": "stderr"}
{"event": "line", "data": "  host      : delicatemastodon.internal.cloudapp.net\n", "pipe": "stderr"}
{"event": "line", "data": "  rank      : 0 (local_rank: 0)\n", "pipe": "stderr"}
{"event": "line", "data": "  exitcode  : 1 (pid: 51458)\n", "pipe": "stderr"}
{"event": "line", "data": "  error_file: <N/A>\n", "pipe": "stderr"}
{"event": "line", "data": "  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html\n", "pipe": "stderr"}
{"event": "line", "data": "============================================================\n", "pipe": "stderr"}
{"event": "end", "data": {"command": ["torchrun", "--nproc_per_node=2", "--", "-m", "voir", "--config", "/Users/satyaortiz-gagne/travail/mila/milabench/extra/timm/voirconf-davit_large-multi.0-0efae956f1553a76c1e03985181900f5.json", "/mnt/Users/satyaortiz-gagne/travail/mila/CODE/milabench/benchmarks/timm/pytorch-image-models/train.py", "--amp", "--model", "davit_large", "--batch-size", "128", "--lr-base", "0.01", "--data-dir", "/Users/satyaortiz-gagne/travail/mila/milabench/data", "--dataset", "FakeImageNet", "--output", "/Users/satyaortiz-gagne/travail/mila/milabench/extra/timm/vodofeze.2024-04-09_00:35:28.669482/davit_large-multi.0", "--checkpoint-hist", "1"], "time": 1712623532.3300037, "return_code": 1}, "pipe": null}
